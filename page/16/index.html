<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"dawnzzz.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="个人博客站点">
<meta property="og:type" content="website">
<meta property="og:title" content="Dawn&#39;s Blogs">
<meta property="og:url" content="http://dawnzzz.github.io/page/16/index.html">
<meta property="og:site_name" content="Dawn&#39;s Blogs">
<meta property="og:description" content="个人博客站点">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="DawnZH">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://dawnzzz.github.io/page/16/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Dawn's Blogs</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Dawn's Blogs</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">分享技术 记录成长</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://dawnzzz.github.io/2023/05/22/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-6-%E4%BA%8B%E4%BB%B6%E6%BA%AF%E6%BA%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="DawnZH">
      <meta itemprop="description" content="个人博客站点">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dawn's Blogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/05/22/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-6-%E4%BA%8B%E4%BB%B6%E6%BA%AF%E6%BA%90/" class="post-title-link" itemprop="url">微服务架构设计模式 (6) 事件溯源</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-05-22 21:15:04" itemprop="dateCreated datePublished" datetime="2023-05-22T21:15:04+08:00">2023-05-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-12-15 10:35:06" itemprop="dateModified" datetime="2023-12-15T10:35:06+08:00">2023-12-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">微服务架构设计模式</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="事件溯源"><a href="#事件溯源" class="headerlink" title="事件溯源"></a>事件溯源</h1><p>事件溯源是一种以<strong>事件</strong>为中心的技术，用于实现业务逻辑和持久化。</p>
<p>使用事件溯源的方式的<strong>好处</strong>是：</p>
<ul>
<li>提供准确的事件审计信息，保留聚合的历史。</li>
<li>与领域事件的发布是天然的契合的。</li>
</ul>
<p><strong>弊端</strong>在于：</p>
<ul>
<li>更改了现有的业务实现逻辑，与传统的逻辑完全不同。</li>
<li>事件的结构可能发生改变，那么如何兼容新版本和旧版本事件是需要解决的问题。</li>
<li>删除是通过记录删除事件的形式进行的，这不是真正意义上的物理删除。</li>
</ul>
<h2 id="持久化"><a href="#持久化" class="headerlink" title="持久化"></a>持久化</h2><p>使用事件溯源进行<strong>持久化</strong>时，与传统的数据库表设计不同。传统的数据库表设计中，仅仅保存聚合的最终状态，一旦聚合的状态发生变化并进行了持久化，那么之前的状态我们是无从知晓的。但是在<strong>事件溯源</strong>中，存储的是聚合相关的<strong>事件</strong>，每一个条目都保存了<strong>事件类型</strong>（创建、修改、删除等），聚合的<strong>唯一标识符</strong>，以及<strong>序列化的事件</strong>（如 json 格式）。</p>
<blockquote>
<p>使用事件溯源的方式组织表结构，通过<strong>检索</strong>并<strong>重放</strong>对应聚合的所有事件来重建聚合。</p>
</blockquote>
<h2 id="实现业务逻辑"><a href="#实现业务逻辑" class="headerlink" title="实现业务逻辑"></a>实现业务逻辑</h2><p>使用事件溯源<strong>实现业务逻辑</strong>时，与传统的方法不同。在传统的方法中，会更新聚合的一个或者多个字段，更新之后再将聚合的最终状态存储在数据库当中。在事件溯源中，实现业务逻辑的结果就是<strong>产生一系列的事件</strong>，事件表示进行的状态更改操作，并将这些事件存储在数据库中。</p>
<h2 id="使用快照优化"><a href="#使用快照优化" class="headerlink" title="使用快照优化"></a>使用快照优化</h2><p>使用时间溯源的方式存储数据库时，一个聚合可能会产生大量的事件，随着时间的推移，重放事件的成本会越来越高。</p>
<p>优化的方法就是定期的存储聚合状态的<strong>快照</strong>，然后通过加载快照，以及重放快照之后的事件来达到快速重放事件。</p>
<p><img src="/../images/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-6-%E4%BA%8B%E4%BB%B6%E6%BA%AF%E6%BA%90/image-20230522223919695.png" alt="image-20230522223919695"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://dawnzzz.github.io/2023/05/21/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-5-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E4%B8%AD%E7%9A%84%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="DawnZH">
      <meta itemprop="description" content="个人博客站点">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dawn's Blogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/05/21/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-5-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E4%B8%AD%E7%9A%84%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A1/" class="post-title-link" itemprop="url">微服务架构设计模式 (5) 微服务架构中的业务逻辑设计</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-05-21 21:15:07" itemprop="dateCreated datePublished" datetime="2023-05-21T21:15:07+08:00">2023-05-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-12-15 10:35:06" itemprop="dateModified" datetime="2023-12-15T10:35:06+08:00">2023-12-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">微服务架构设计模式</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="事务脚本模式"><a href="#事务脚本模式" class="headerlink" title="事务脚本模式"></a>事务脚本模式</h1><p>对于<strong>简单</strong>的业务逻辑，可以使用<strong>事务脚本模式</strong>，事务脚本模式是<strong>面向过程</strong>而不是面向对象的。事务脚本模式就是，对于每一种系统操作，都有一个方法专门用于实现这个系统操作，使用数据库访问对象（Dao）访问数据库，而数据对象是纯数据几乎没有行为。</p>
<blockquote>
<p>事务脚本模式的重要特征就是实现行为的类于存储状态的类是分开的。</p>
</blockquote>
<p><img src="/../images/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-5-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E4%B8%AD%E7%9A%84%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A1/image-20230521212736373.png" alt="image-20230521212736373"></p>
<h1 id="领域模型模式"><a href="#领域模型模式" class="headerlink" title="领域模型模式"></a>领域模型模式</h1><p>对于复杂的业务，就需要使用<strong>领域模型模式</strong>了，领域模型模式是<strong>面向对象</strong>的。领域模型模式将业务逻辑组织为<strong>具有状态和行为的类</strong>构成的对象模型。这样的设计中，有些类只有状态或者行为，但是很多类同时包含状态和行为。</p>
<p>这样设计的好处是：</p>
<ul>
<li><strong>易于理解和维护</strong>。它不像事务脚本模式由一个完成所有事情的大类组成，而是由许多小类组成，每个小类都有少量的职责。</li>
<li><strong>更容易测试</strong>。每一个对象都能够被独立的测试。</li>
<li><strong>更容易扩展</strong>。通常而言，面向对象的设计可以使用设计模式，这样提供了易于扩展的可能性。</li>
</ul>
<p><img src="/../images/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-5-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E4%B8%AD%E7%9A%84%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A1/image-20230521213659409.png" alt="image-20230521213659409"></p>
<h2 id="领域驱动设计"><a href="#领域驱动设计" class="headerlink" title="领域驱动设计"></a>领域驱动设计</h2><p>领域模型模式需要用<strong>领域驱动设计（DDD）</strong>来优化，DDD 是对面向对象设计的改进，是开发复杂业务逻辑的一种方法。在领域驱动设计中，由以下几种基本元素组成：</p>
<ul>
<li><strong>Entity：</strong>具有<strong>状态</strong>的对象。</li>
<li><strong>Value Object：</strong>不具有状态的对象，<strong>仅有值</strong>，具有相同的值对象可以互换使用。</li>
<li><strong>Factory：</strong>复杂实现对象创建的方法或者对象。</li>
<li><strong>Repository：</strong>用来<strong>访问持久化实体</strong>的对象，Repository 也封装了访问数据库的底层机制。</li>
<li><strong>Service：</strong>实现<strong>业务逻辑</strong>的对象。</li>
</ul>
<h2 id="领域驱动设计聚合模式"><a href="#领域驱动设计聚合模式" class="headerlink" title="领域驱动设计聚合模式"></a>领域驱动设计聚合模式</h2><p>传统的领域模型<strong>缺少明确的边界</strong>，这会导致一些问题。所以使用领域驱动设计中的<strong>聚合</strong>模式，聚合具有明确的边界。</p>
<p><strong>聚合</strong>是一个边界内领域对象的集群，可以将其视为<strong>一个单元</strong>。使用聚合有两个好处：</p>
<ul>
<li>消除了服务之间的对象引用。</li>
<li>确保了本地事务 ACID 在每一个服务内部（对于服务之间的事务性保证，则通过 Saga 实现）。</li>
</ul>
<p><img src="/../images/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-5-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E4%B8%AD%E7%9A%84%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A1/image-20230522140855911.png" alt="image-20230522140855911"></p>
<blockquote>
<p>所有的操作都<strong>作用于整个聚合</strong>而不是部分聚合。</p>
</blockquote>
<h3 id="聚合的规则"><a href="#聚合的规则" class="headerlink" title="聚合的规则"></a>聚合的规则</h3><p>领域驱动设计要求聚合遵守一组规则：</p>
<ul>
<li><strong>只引用聚合根：</strong>聚合根（Aggregate Root）是聚合中唯一可以由外部类引用的部分，客户端只能调用聚合根上的方法来更新聚合。</li>
<li><strong>聚合间的引用必须使用主键：</strong>聚合间的引用使用<strong>主键</strong>（如唯一 ID，可以看成是<strong>外键</strong>），而不是对象引用。它确保聚合之间的<strong>边界</strong>得到了良好的定义，不会出现跨服务的<strong>对象引用问题</strong>。</li>
<li><strong>一个事务中，只能创建或者更新一个聚合：</strong>确保单个事务的范围不超过服务的边界，<strong>使用 Saga 可以解决</strong>创建或者更新<strong>多个</strong>聚合。</li>
</ul>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2023/05/21/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-5-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E4%B8%AD%E7%9A%84%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A1/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://dawnzzz.github.io/2023/05/18/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-4-%E4%BD%BF%E7%94%A8Saga%E7%AE%A1%E7%90%86%E4%BA%8B%E5%8A%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="DawnZH">
      <meta itemprop="description" content="个人博客站点">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dawn's Blogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/05/18/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-4-%E4%BD%BF%E7%94%A8Saga%E7%AE%A1%E7%90%86%E4%BA%8B%E5%8A%A1/" class="post-title-link" itemprop="url">微服务架构设计模式 (4) 使用Saga管理事务</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-05-18 16:58:39" itemprop="dateCreated datePublished" datetime="2023-05-18T16:58:39+08:00">2023-05-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-12-15 10:35:06" itemprop="dateModified" datetime="2023-12-15T10:35:06+08:00">2023-12-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">微服务架构设计模式</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Saga-分布式事务"><a href="#Saga-分布式事务" class="headerlink" title="Saga 分布式事务"></a>Saga 分布式事务</h1><p>Saga 是一种分布式事务实现方式，Saga 通过<strong>异步消息</strong>来协调<strong>一系列的本地事务</strong>，从而维护多个服务之间的数据一致性。</p>
<blockquote>
<p>异步消息的一个重要好处就是<strong>确保 Saga 的所有步骤都被执行</strong>，即使一个或者多个 Saga 的参与方暂时不可用。</p>
</blockquote>
<p>Saga 缺少了 ACID 事务中的隔离性。此外，因为每个本地事务都提交了更改，必须使用<strong>补偿事务（只有修改操作有补偿事务）</strong>回滚 Saga。</p>
<p>在 Saga 的一系列的步骤中，若前 N 个步骤后面跟着的步骤可能失败，称为<strong>可补偿性事务</strong>。第 N+1 个步骤后面全部都是不可能失败的步骤，称 N+1 步骤为<strong>关键性事务</strong>。关键性之后的步骤称之为<strong>可重复性事务</strong>。</p>
<h2 id="Saga-的协调模式"><a href="#Saga-的协调模式" class="headerlink" title="Saga 的协调模式"></a>Saga 的协调模式</h2><p>Saga 由一些列本地事务组成，如何协调 Saga 中一系列的本地事务进行下一步操作还是执行补偿事务尤为关键，总共有两种方式：</p>
<ul>
<li><strong>协同式：</strong>把 Saga 的决策和执行顺序<strong>分布在 Saga 的每一个参与方中</strong>，它们通过交换事件的方式进行沟通。</li>
<li><strong>编排式：</strong>将 Saga 的决策和执行顺序集中在一个<strong>集中的编排器</strong>中，编排器发送消息给各个Saga 参与方。</li>
</ul>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2023/05/18/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-4-%E4%BD%BF%E7%94%A8Saga%E7%AE%A1%E7%90%86%E4%BA%8B%E5%8A%A1/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://dawnzzz.github.io/2023/05/17/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-3-%E8%BF%9B%E7%A8%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="DawnZH">
      <meta itemprop="description" content="个人博客站点">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dawn's Blogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/05/17/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-3-%E8%BF%9B%E7%A8%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1/" class="post-title-link" itemprop="url">微服务架构设计模式 (3) 进程间的通信</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-05-17 20:25:24" itemprop="dateCreated datePublished" datetime="2023-05-17T20:25:24+08:00">2023-05-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-12-15 10:35:06" itemprop="dateModified" datetime="2023-12-15T10:35:06+08:00">2023-12-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">微服务架构设计模式</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="微服务架构的进程间通信概述"><a href="#微服务架构的进程间通信概述" class="headerlink" title="微服务架构的进程间通信概述"></a>微服务架构的进程间通信概述</h1><h2 id="交互方式"><a href="#交互方式" class="headerlink" title="交互方式"></a>交互方式</h2><p>交互方式有两个维度来表示：一对一和一对多，同步和异步。</p>
<table>
<thead>
<tr>
<th></th>
<th>一对一</th>
<th>一对多</th>
</tr>
</thead>
<tbody><tr>
<td>同步</td>
<td>请求/响应</td>
<td>无</td>
</tr>
<tr>
<td>异步</td>
<td>异步请求/响应；单向通知</td>
<td>发布/订阅；发布/异步响应</td>
</tr>
</tbody></table>
<ul>
<li>一对一的交互方式：<ul>
<li><strong>请求/响应：</strong>客户端发起请求，阻塞等待服务器的响应。这样的方式会导致服务的紧耦合。</li>
<li><strong>异步请求/响应：</strong>客户端发起，服务端异步响应，客户端在等待时不会阻塞。</li>
<li><strong>单向通知：</strong>客户端请求发送到服务端，不期望服务端做出任何响应。</li>
</ul>
</li>
<li>一对多的交互方式：<ul>
<li><strong>发布/订阅：</strong>客户端发布通知消息，被零个或者多个服务端订阅。</li>
<li><strong>发布/异步响应：</strong>客户端发布请求消息，等待从感兴趣的服务发回的响应。</li>
</ul>
</li>
</ul>
<blockquote>
<p>每个服务通常是上述交互方式的<strong>组合</strong>。</p>
</blockquote>
<h2 id="服务-API"><a href="#服务-API" class="headerlink" title="服务 API"></a>服务 API</h2><h3 id="API-定义"><a href="#API-定义" class="headerlink" title="API 定义"></a>API 定义</h3><p>在微服务架构中，使用<strong>接口定义语言（IDL）</strong>精确定义服务的 API 接口。</p>
<p>IDL 是客户端和服务端之间的契约，一个良好的 API 定义暴露有用功能的同时隐藏了内部实现的细节。</p>
<h3 id="API-的演化"><a href="#API-的演化" class="headerlink" title="API 的演化"></a>API 的演化</h3><blockquote>
<p>服务的 API 很少一成不变，它可能会随着时间的推移而发展。</p>
</blockquote>
<p>在微服务架构中变更 API 是困难的，因为服务 API 的调用方无法控制 API 的实现方式，而 服务 API 的提供方无法控制客户端与服务端的版本保持一致。所以需要对服务 API 进行<strong>版本控制</strong>。</p>
<p>语义化版本控制要求版本号由三部分组成：Major.Minor.Patch</p>
<ul>
<li>Major：可能对之前的版本不兼容。</li>
<li>Minor：进行后向兼容的增强。</li>
<li>Patch：进行后向兼容的错误修复。</li>
</ul>
<h2 id="消息的格式"><a href="#消息的格式" class="headerlink" title="消息的格式"></a>消息的格式</h2><h3 id="基于文本的消息格式"><a href="#基于文本的消息格式" class="headerlink" title="基于文本的消息格式"></a>基于文本的消息格式</h3><p>基于文本的消息格式，如 Json 和 XML。</p>
<p>这种消息格式的好处是：<strong>可读性高、后向兼容</strong>。而弊端在于消息冗长、传输效率低。</p>
<h3 id="基于二进制的消息格式"><a href="#基于二进制的消息格式" class="headerlink" title="基于二进制的消息格式"></a>基于二进制的消息格式</h3><p>基于二进制的消息格式，如 Protobuf，Thrift 和 Avro。</p>
<ul>
<li><strong>Protobuf：</strong><ul>
<li>优点：时间和空间效率都不错，支持前向兼容（新加字段采用默认值）和后向兼容（忽略新加的字段），支持多语言。基于 HTTP 2.0。</li>
<li>缺点：可读性差，不支持动态生成消息类型。</li>
</ul>
</li>
<li><strong>Thrift：</strong><ul>
<li>优点：不仅支持二进制也支持文本类型的消息格式（支持多种序列化方式），支持多种传输协议，支持多语言，支持同步和异步通信。可以直接基于 TCP，省去了额外应用层开销。</li>
<li>缺点：不支持动态生成消息类型。</li>
</ul>
</li>
<li>Arvo：<ul>
<li>优点：在握手阶段交换模式定义（支持动态生成消息类型）。</li>
<li>缺点：语言支持不丰富，在解析消息之前需要知道它的格式不支持后向兼容。</li>
</ul>
</li>
</ul>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2023/05/17/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-3-%E8%BF%9B%E7%A8%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://dawnzzz.github.io/2023/05/17/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-2-%E6%9C%8D%E5%8A%A1%E7%9A%84%E6%8B%86%E5%88%86%E7%AD%96%E7%95%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="DawnZH">
      <meta itemprop="description" content="个人博客站点">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dawn's Blogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/05/17/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-2-%E6%9C%8D%E5%8A%A1%E7%9A%84%E6%8B%86%E5%88%86%E7%AD%96%E7%95%A5/" class="post-title-link" itemprop="url">微服务架构设计模式 (2) 服务的拆分策略</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-05-17 16:23:59" itemprop="dateCreated datePublished" datetime="2023-05-17T16:23:59+08:00">2023-05-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-12-15 10:35:06" itemprop="dateModified" datetime="2023-12-15T10:35:06+08:00">2023-12-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">微服务架构设计模式</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="如何定义一个微服务架构"><a href="#如何定义一个微服务架构" class="headerlink" title="如何定义一个微服务架构"></a>如何定义一个微服务架构</h1><p>定义一个应用程序的微服务架构分为三步式流程，注意这些只是一个大概的方法。</p>
<ul>
<li><strong>第一步，定义系统操作</strong>。系统操作指的是应用程序必须处理的请求的一种抽象描述，所以这一步就是将需求提炼为各种关键请求。</li>
<li><strong>第二步，定义服务</strong>。就是如何分解服务。</li>
<li><strong>第三步，定义服务 API 和协作方式</strong>。确定每一个服务的 API，将第一步中标识的系统操作分配给服务，服务可以独立的实现操作，也可能需要与其他服务进行写作。</li>
</ul>
<p><img src="/../images/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-2-%E6%9C%8D%E5%8A%A1%E7%9A%84%E6%8B%86%E5%88%86%E7%AD%96%E7%95%A5/image-20230517172041533.png" alt="image-20230517172041533"></p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2023/05/17/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-2-%E6%9C%8D%E5%8A%A1%E7%9A%84%E6%8B%86%E5%88%86%E7%AD%96%E7%95%A5/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://dawnzzz.github.io/2023/05/17/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-1-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E4%BB%8B%E7%BB%8D/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="DawnZH">
      <meta itemprop="description" content="个人博客站点">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dawn's Blogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/05/17/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-1-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E4%BB%8B%E7%BB%8D/" class="post-title-link" itemprop="url">微服务架构设计模式 (1) 微服务架构介绍</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-05-17 14:36:39" itemprop="dateCreated datePublished" datetime="2023-05-17T14:36:39+08:00">2023-05-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-12-15 10:35:06" itemprop="dateModified" datetime="2023-12-15T10:35:06+08:00">2023-12-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">微服务架构设计模式</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="微服务架构"><a href="#微服务架构" class="headerlink" title="微服务架构"></a>微服务架构</h1><h2 id="应用程序的扩展方式"><a href="#应用程序的扩展方式" class="headerlink" title="应用程序的扩展方式"></a>应用程序的扩展方式</h2><p>在解释什么是微服务架构之前，先看看一个应用程序的三种扩展方式：</p>
<ul>
<li><strong>X 轴扩展：</strong>又称为水平复制，通过<strong>克隆实例</strong>再加上<strong>负载均衡器</strong>进行的扩展方法，负载均衡器在 N 个相同的实例之间分配请求。</li>
</ul>
<p><img src="/../images/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-1-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E4%BB%8B%E7%BB%8D/image-20230517144048395.png" alt="image-20230517144048395"></p>
<ul>
<li><strong>Z 轴扩展：</strong>又称为数据分区，也需要运行单体应用程序的多个实例，但是<strong>每一个实例仅负责数据的一个子集</strong>。路由器根据请求中的特定属性将请求路由到特定的实例中去。</li>
</ul>
<p><img src="/../images/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-1-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E4%BB%8B%E7%BB%8D/image-20230517144336551.png" alt="image-20230517144336551"></p>
<ul>
<li><strong>Y 轴扩展：</strong>又称为功能性分解，<strong>把单体应用拆解为了一组服务</strong>，每一种服务都负责特定的功能。服务可以在<strong>需要的时候再进行 X 轴或者 Z 轴扩展</strong>。</li>
</ul>
<p><img src="/../images/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-1-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E4%BB%8B%E7%BB%8D/image-20230517144500811.png" alt="image-20230517144500811"></p>
<h2 id="微服务架构定义"><a href="#微服务架构定义" class="headerlink" title="微服务架构定义"></a>微服务架构定义</h2><blockquote>
<p>所以，<strong>微服务架构</strong>就是把应用程序根据功能分解为一组服务的架构风格。每一种服务都是由一组专注的、内聚的功能职责组成。</p>
</blockquote>
<p>微服务架构就是<strong>将服务作为模块化的单元</strong>。你只能通过 API 去访问服务，而无法越过 API 去访问服务内部的类。这使得服务可以独立的进行部署和扩展。</p>
<p>微服务架构的一个关键的特性就是每一种服务之间都是<strong>松耦合</strong>的，它们仅仅通过 API 进行通信。而为了实现这一种松耦合，<strong>每一个服务都拥有自己的私有数据库</strong>。这样对于一个服务，可以自由的修改数据库表的 Schema，而不必与其他服务进行协调。服务<strong>不会因为其他服务锁住了数据库</strong>而进入了<strong>堵塞</strong>状态。</p>
<blockquote>
<p><strong>微服务架构 vs SOA</strong></p>
<p>SOA（Service Oriented Architecture）指的是面向服务的架构，SOA 也是进行了服务划分，它与微服务架构看似相同，但是深入研究就会发现二者的巨大差异。</p>
<ul>
<li><strong>服务间的通信：</strong>SOA 常吃采用重量级的技术，如 ESB（Enterprise Service Bus）、SOAP 和 WebService。而微服务架构倾向于使用轻量级的技术，如 REST 或者 gRPC 这类轻量级的协议。</li>
<li><strong>数据管理：</strong>SOA 一般有一个全局的数据库。而微服务与之相反，每一个服务都有一个自己的私有数据模型。</li>
<li><strong>服务规模：</strong>SOA 应用通常包含若干个大型的服务。而微服务架构则常常由属实个甚至上百个更小的服务组成。</li>
</ul>
</blockquote>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2023/05/17/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-1-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E4%BB%8B%E7%BB%8D/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://dawnzzz.github.io/2023/05/17/Kubernetes%E5%AD%A6%E4%B9%A0-6-Pod%E5%92%8C%E5%B7%A5%E4%BD%9C%E8%B4%9F%E8%BD%BD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="DawnZH">
      <meta itemprop="description" content="个人博客站点">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dawn's Blogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/05/17/Kubernetes%E5%AD%A6%E4%B9%A0-6-Pod%E5%92%8C%E5%B7%A5%E4%BD%9C%E8%B4%9F%E8%BD%BD/" class="post-title-link" itemprop="url">Kubernetes学习 (6) Pod和工作负载</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-05-17 13:30:58" itemprop="dateCreated datePublished" datetime="2023-05-17T13:30:58+08:00">2023-05-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-12-15 10:35:06" itemprop="dateModified" datetime="2023-12-15T10:35:06+08:00">2023-12-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kubernetes%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index"><span itemprop="name">Kubernetes学习</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Pod"><a href="#Pod" class="headerlink" title="Pod"></a>Pod</h1><p><strong>Pod</strong> 是可以在 Kubernetes 中创建和管理的、最小的可部署的计算单元，是<strong>一组容器</strong>，这些容器<strong>共享存储、网络（容器间可以使用 localhost 相互通信）、以及怎样运行这些容器的声明</strong>。有些 Pod 具有 Init 容器和应用容器，Init 容器会在启动应用容器之前运行并完成。</p>
<p>如下面是一个 Nginx Pod 示例：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nginx:1.14.2</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">80</span></span><br></pre></td></tr></table></figure>

<p>通常情况下，使用 Deployment、ReplicaSet 或者 Job 这类<strong>工作负载</strong>来创建 Pod，如果 Pod 需要跟踪状态，可以考虑 StatefulSet 资源。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2023/05/17/Kubernetes%E5%AD%A6%E4%B9%A0-6-Pod%E5%92%8C%E5%B7%A5%E4%BD%9C%E8%B4%9F%E8%BD%BD/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://dawnzzz.github.io/2023/05/17/Kubernetes%E5%AD%A6%E4%B9%A0-5-Kubernetes%E5%AF%B9%E8%B1%A1%E4%B9%8BFinalizer-%E5%B1%9E%E4%B8%BB%E4%B8%8E%E9%99%84%E5%B1%9E/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="DawnZH">
      <meta itemprop="description" content="个人博客站点">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dawn's Blogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/05/17/Kubernetes%E5%AD%A6%E4%B9%A0-5-Kubernetes%E5%AF%B9%E8%B1%A1%E4%B9%8BFinalizer-%E5%B1%9E%E4%B8%BB%E4%B8%8E%E9%99%84%E5%B1%9E/" class="post-title-link" itemprop="url">Kubernetes学习 (5) Kubernetes对象之Finalizer 属主与附属</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-05-17 10:46:36" itemprop="dateCreated datePublished" datetime="2023-05-17T10:46:36+08:00">2023-05-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-12-15 10:35:06" itemprop="dateModified" datetime="2023-12-15T10:35:06+08:00">2023-12-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kubernetes%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index"><span itemprop="name">Kubernetes学习</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Finalizers"><a href="#Finalizers" class="headerlink" title="Finalizers"></a>Finalizers</h1><p>带有 Finalizers 的对象删除流程如下：</p>
<ul>
<li>对带有 Finalizer 的对象的第一个删除请求会为其 <code>metadata.deletionTimestamp</code> 设置一个值（标记要删除的对象），但不会真的删除对象。并且 API 服务会禁止对象被删除，直到其 <code>metadata.finalizers</code> 字段为空。返回 202 状态码。</li>
<li>此时控制平面会通过<strong>轮询</strong>对该对象的更新请求来执行它们所要处理的所有 Finalizer。<code>metadata.deletionGracePeriodSeconds</code> 的取值控制对更新的轮询周期。</li>
<li><strong>当所有 Finalizer 都被执行过，资源被删除</strong>。每执行完一个就从 <code>finalizers</code> 中移除一个，直到 <code>finalizers</code> 为空，之后其宿主资源才会被真正的删除。</li>
</ul>
<blockquote>
<p>一个常见的 Finalizer 的例子是 <code>kubernetes.io/pv-protection</code>， 它用来防止意外删除 <code>PersistentVolume</code> 对象。 当一个 <code>PersistentVolume</code> 对象被 Pod 使用时， Kubernetes 会添加 <code>pv-protection</code> Finalizer。 如果你试图删除 <code>PersistentVolume</code>，它将进入 <code>Terminating</code> 状态， 但是控制器因为该 Finalizer 存在而无法删除该资源。 当 Pod 停止使用 <code>PersistentVolume</code> 时， Kubernetes 清除 <code>pv-protection</code> Finalizer，控制器就会删除该卷。</p>
</blockquote>
<h1 id="属主与附属"><a href="#属主与附属" class="headerlink" title="属主与附属"></a>属主与附属</h1><p>属主（Owner）和附属（Dependent）用于描述 Kubernetes 对象之间的关系。</p>
<h2 id="属主引用"><a href="#属主引用" class="headerlink" title="属主引用"></a>属主引用</h2><p>附属对象有一个 <code>metadata.ownerReferences</code> 字段，用于引用其属主对象。一个有效的属主引用， 包含与附属对象<strong>同在一个命名空间下的对象名称</strong>和<strong>一个 UID</strong>。Kubernetes 自动为一些对象的附属资源设置属主引用的值， 这些对象包含 ReplicaSet、DaemonSet、Deployment、Job、CronJob、ReplicationController 等。</p>
<p>附属对象还有一个 <code>ownerReferences.blockOwnerDeletion</code> 字段，该字段使用布尔值， 用于控制特定的附属对象是否可以阻止垃圾收集删除其属主对象。</p>
<blockquote>
<p>k8s 不允许跨越命名空间指定属主。</p>
</blockquote>
<h2 id="属主关系与-Finalizer"><a href="#属主关系与-Finalizer" class="headerlink" title="属主关系与 Finalizer"></a>属主关系与 Finalizer</h2><p>在前台删除中，会添加 <code>foreground</code> Finalizer，这样控制器必须在删除了拥有 <code>ownerReferences.blockOwnerDeletion=true</code> 的附属资源后，才能删除属主对象。 如果你指定了孤立删除策略，Kubernetes 会添加 <code>orphan</code> Finalizer， 这样控制器在删除属主对象后，会忽略附属资源。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://dawnzzz.github.io/2023/05/17/Kubernetes%E5%AD%A6%E4%B9%A0-4-Kubernetes%E5%AF%B9%E8%B1%A1%E4%B9%8B%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4%E5%92%8C%E6%B3%A8%E8%A7%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="DawnZH">
      <meta itemprop="description" content="个人博客站点">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dawn's Blogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/05/17/Kubernetes%E5%AD%A6%E4%B9%A0-4-Kubernetes%E5%AF%B9%E8%B1%A1%E4%B9%8B%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4%E5%92%8C%E6%B3%A8%E8%A7%A3/" class="post-title-link" itemprop="url">Kubernetes学习 (4) Kubernetes对象之命名空间和注解</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-05-17 10:19:54" itemprop="dateCreated datePublished" datetime="2023-05-17T10:19:54+08:00">2023-05-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-12-15 10:35:06" itemprop="dateModified" datetime="2023-12-15T10:35:06+08:00">2023-12-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kubernetes%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index"><span itemprop="name">Kubernetes学习</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="命名空间"><a href="#命名空间" class="headerlink" title="命名空间"></a>命名空间</h1><p>在 k8s 中，命名空间（Namespace）提供一种机制，<strong>将同一集群中的资源划分为相互隔离的组</strong>。 同一名字空间内的资源名称要唯一，但跨名字空间时没有这个要求。名字空间作用域仅针对带有名字空间的对象，作用域对集群范围的对象不适用。</p>
<blockquote>
<p>大多数 Kubernetes 资源（如 Pod、Service 等）都在某些命名空间中，但是<strong>名字空间资源本身并不在名字空间中</strong>。</p>
<p>而且<strong>底层资源</strong>，如节点和持久化卷，<strong>不属于任何命名空间</strong>。</p>
<p>查看 Kubernetes 资源哪些在命名空间中，哪些不在：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 位于名字空间中的资源</span></span><br><span class="line">kubectl api-resources --namespaced=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 不在名字空间中的资源</span></span><br><span class="line">kubectl api-resources --namespaced=<span class="literal">false</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="初始命名空间"><a href="#初始命名空间" class="headerlink" title="初始命名空间"></a>初始命名空间</h2><p>Kubernetes 启动时会创建四个初始命名空间：</p>
<ul>
<li><strong>default：</strong>默认的命名空间，以便无需创建新的命名空间就可以使用集群。</li>
<li><strong>kube-node-lease：</strong>包含用于与各个节点关联的租约对象。节点租约允许 Kubelet 发送心跳， 由此控制面能够检测到节点故障。</li>
<li><strong>kube-public：</strong>所有的客户端都可以读取该命名空间。这个命名空间主要预留为集群使用，以便某些资源需要在整个集群中可见可读。</li>
<li><strong>kube-system：</strong>用于 Kubernetes 系统创建的对象。</li>
</ul>
<h2 id="命名空间和-DNS"><a href="#命名空间和-DNS" class="headerlink" title="命名空间和 DNS"></a>命名空间和 DNS</h2><p>在<strong>创建一个服务</strong>时，Kubernetes 会<strong>创建一个相应的 DNS 条目</strong>。</p>
<p>条目的内容为 <code>&lt;服务名称&gt;.&lt;名字空间名称&gt;.svc.cluster.local</code>，这意味着对于<strong>本地命名空间的服务</strong>，可以只使用 <code>&lt;服务名称&gt;</code> 就可以访问到。而对于<strong>不同的命名空间</strong>，则需要使用使用完全限定域名（FQDN）。</p>
<h1 id="注解"><a href="#注解" class="headerlink" title="注解"></a>注解</h1><p>使用 Kubernetes 注解为对象<strong>附加任意的非标识的元数据</strong>。客户端程序能够获取这些元数据信息。</p>
<blockquote>
<p><strong>标签</strong>可以用来<strong>选择</strong>对象和<strong>查找</strong>满足某些条件的对象集合。 相反，<strong>注解不用于标识和选择对象</strong>。</p>
</blockquote>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">metadata:</span></span><br><span class="line">	<span class="attr">annotations:</span></span><br><span class="line">		<span class="attr">key1:</span> <span class="string">value1</span></span><br><span class="line">		<span class="attr">key2:</span> <span class="string">value2</span></span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://dawnzzz.github.io/2023/05/16/Kubernetes%E5%AD%A6%E4%B9%A0-3-Kubernetes%E5%AF%B9%E8%B1%A1%E4%B9%8B%E5%AF%B9%E8%B1%A1%E5%90%8D%E7%A7%B0%E5%92%8CID-%E6%A0%87%E7%AD%BE%E5%92%8C%E9%80%89%E6%8B%A9%E7%AC%A6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="DawnZH">
      <meta itemprop="description" content="个人博客站点">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dawn's Blogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/05/16/Kubernetes%E5%AD%A6%E4%B9%A0-3-Kubernetes%E5%AF%B9%E8%B1%A1%E4%B9%8B%E5%AF%B9%E8%B1%A1%E5%90%8D%E7%A7%B0%E5%92%8CID-%E6%A0%87%E7%AD%BE%E5%92%8C%E9%80%89%E6%8B%A9%E7%AC%A6/" class="post-title-link" itemprop="url">Kubernetes学习 (3) Kubernetes对象之对象名称和ID 标签和选择符</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-05-16 22:48:08" itemprop="dateCreated datePublished" datetime="2023-05-16T22:48:08+08:00">2023-05-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-12-15 10:35:06" itemprop="dateModified" datetime="2023-12-15T10:35:06+08:00">2023-12-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kubernetes%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index"><span itemprop="name">Kubernetes学习</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="对象名称和-ID"><a href="#对象名称和-ID" class="headerlink" title="对象名称和 ID"></a>对象名称和 ID</h1><p>集群中每一个对象都有一个名称（name）来标识在同类资源中的唯一性，每一个对象也有一个 UID 来标识在整个集群中的唯一性。</p>
<h2 id="名称"><a href="#名称" class="headerlink" title="名称"></a>名称</h2><p>名称在同类资源中是唯一的。</p>
<blockquote>
<p>当对象所代表的是一个<strong>物理实体</strong>（例如代表一台物理主机的 Node）时， <strong>如果在 Node 对象未被删除并重建的条件下</strong>，<strong>重新创建</strong>了同名的物理主机， 则 Kubernetes 会<strong>将新的主机看作是老的主机</strong>，这可能会带来某种不一致性。</p>
</blockquote>
<h2 id="UID"><a href="#UID" class="headerlink" title="UID"></a>UID</h2><p>UID 是 k8s 系统生成的全局唯一标识符。</p>
<h1 id="标签和选择符"><a href="#标签和选择符" class="headerlink" title="标签和选择符"></a>标签和选择符</h1><p>标签是附加到 Kubernetes 对象上的键值对。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">metadata:</span></span><br><span class="line">	<span class="attr">name:</span> <span class="string">demo</span></span><br><span class="line">	<span class="attr">labels:</span></span><br><span class="line">		<span class="attr">key1:</span> <span class="string">value1</span></span><br><span class="line">		<span class="attr">key2:</span> <span class="string">value2</span></span><br></pre></td></tr></table></figure>

<h2 id="选择符"><a href="#选择符" class="headerlink" title="选择符"></a>选择符</h2><p>通过标签选择符，用户可以识别一组对象。</p>
<p>API 目前支持两种类型的选择算符：<strong>基于等值的</strong>和<strong>基于集合的</strong>。 标签选择算符可以由逗号分隔的多个<strong>需求</strong>组成。 在多个需求的情况下，必须满足所有要求，因此逗号分隔符充当逻辑<strong>与</strong>运算符。</p>
<h3 id="基于等值的运算符"><a href="#基于等值的运算符" class="headerlink" title="基于等值的运算符"></a>基于等值的运算符</h3><p>基于等值的运算符有三种 <code>=</code>、<code>==</code> 和 <code>!=</code>，前两者标识同义的相等，第三个是不相等。</p>
<h3 id="基于集合的运算符"><a href="#基于集合的运算符" class="headerlink" title="基于集合的运算符"></a>基于集合的运算符</h3><p>基于集合的运算符有三种 <code>in</code>、<code>notin</code> 和 <code>exists</code>。</p>
<ul>
<li>key in (v1, v2)</li>
<li>key：有 key 标签的对象。</li>
<li>!key：没有 key 标签的对象。</li>
</ul>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2023/05/16/Kubernetes%E5%AD%A6%E4%B9%A0-3-Kubernetes%E5%AF%B9%E8%B1%A1%E4%B9%8B%E5%AF%B9%E8%B1%A1%E5%90%8D%E7%A7%B0%E5%92%8CID-%E6%A0%87%E7%AD%BE%E5%92%8C%E9%80%89%E6%8B%A9%E7%AC%A6/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/15/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><span class="page-number current">16</span><a class="page-number" href="/page/17/">17</a><span class="space">&hellip;</span><a class="page-number" href="/page/42/">42</a><a class="extend next" rel="next" href="/page/17/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">DawnZH</p>
  <div class="site-description" itemprop="description">个人博客站点</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">418</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">53</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">51</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">DawnZH</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
